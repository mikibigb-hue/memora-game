<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Memora | P1 Spelling Master</title>
    <style>
        :root { 
            --bg: #0d0221; --card: #240b36; --primary: #00f2ff; 
            --accent: #7000ff; --success: #39ff14; --error: #ff0055; --text: #ffffff;
        }
        body { 
            background: var(--bg); color: var(--text); font-family: 'Segoe UI', sans-serif; 
            display: flex; flex-direction: column; align-items: center; justify-content: center; 
            min-height: 100vh; margin: 0; overflow: hidden;
        }
        
        /* Monospaced Word Styling for Stability */
        .word-float { 
            position: absolute; 
            font-size: 55px; 
            font-weight: 900; 
            font-family: 'Courier New', Courier, monospace; 
            color: var(--primary); 
            width: 100%; 
            text-align: center;
            text-shadow: 0 0 15px var(--primary); 
            z-index: 5;
            white-space: pre;
        }
        
        .missing { 
            color: #ffeb3b; 
            border-bottom: 5px solid #ffeb3b; 
            display: inline-block;
            width: 45px; 
            text-align: center;
        }

        .brand-name {
            font-size: 3.5rem; font-weight: 900; color: var(--primary);
            text-transform: uppercase; letter-spacing: 8px; margin-bottom: 10px;
            text-shadow: 0 0 10px var(--primary), 0 0 20px var(--accent);
            animation: pulse-glow 2s infinite alternate;
        }

        @keyframes pulse-glow {
            from { text-shadow: 0 0 10px var(--primary); transform: scale(1); }
            to { text-shadow: 0 0 25px var(--primary), 0 0 40px var(--accent); transform: scale(1.05); }
        }

        .header-container { display: flex; align-items: center; justify-content: center; gap: 20px; margin-bottom: 20px; }
        .side-img { width: 60px; height: 60px; filter: drop-shadow(0 0 8px var(--primary)); }

        .screen { display: none; text-align: center; width: 90%; max-width: 850px; 
                  background: var(--card); padding: 40px; border-radius: 25px; 
                  box-shadow: 0 0 40px rgba(112, 0, 255, 0.3); border: 2px solid var(--accent); }
        .active { display: block; animation: fadeIn 0.4s; }

        .grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 12px; margin: 20px 0; }
        
        #game-area { position: relative; height: 400px; border: 2px solid var(--accent); 
                     margin: 15px 0; overflow: hidden; background: #000; border-radius: 15px; }
        
        #feedback-mark { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); 
                         font-size: 100px; pointer-events: none; opacity: 0; z-index: 20; transition: 0.1s; }

        /* BUTTON STYLES */
        #controls { display: flex; justify-content: center; gap: 10px; flex-wrap: wrap; }
        button { background: linear-gradient(45deg, var(--accent), var(--primary)); color: white; 
                  border: none; padding: 12px 20px; border-radius: 12px; font-weight: bold; 
                  cursor: pointer; transition: 0.2s; text-transform: uppercase; font-size: 14px; }
        button:hover { transform: translateY(-3px); box-shadow: 0 5px 15px var(--primary); }
        .btn-end { background: linear-gradient(45deg, #8b0000, var(--error)); border: 1px solid var(--error); }
        .btn-home { background: #333; }
        .btn-replay { background: #444; }

        .fall-guy { position: absolute; font-size: 80px; left: 50%; transform: translateX(-50%); z-index: 10; }
        .splash-fx { position: absolute; bottom: 0; width: 100%; height: 100%; background: rgba(255, 0, 85, 0.4); pointer-events: none; display: none; }

        .stats-bar { display: flex; justify-content: space-around; font-size: 1.2rem; 
                     margin-bottom: 20px; color: var(--primary); font-family: monospace; }
        .stat-item { padding: 5px 10px; border-radius: 8px; background: rgba(0,0,0,0.3); }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes shake { 0%, 100% { transform: translate(0, 0); } 25% { transform: translate(-5px, 0); } 75% { transform: translate(5px, 0); } }
        .shake { animation: shake 0.2s ease-in-out; border-color: var(--error) !important; }
    </style>
</head>
<body>

    <div id="setup-screen" class="screen active">
        <div class="brand-name">MEMORA</div>
        <div class="header-container">
            <img src="https://cdn-icons-png.flaticon.com/512/1048/1048953.png" class="side-img">
            <h1 style="font-size: 2rem; margin:0; color: #fff;">P1: SPELLING MASTER</h1>
            <img src="https://cdn-icons-png.flaticon.com/512/3112/3112946.png" class="side-img">
        </div>
        <div style="background: rgba(0,0,0,0.3); padding: 20px; border-radius: 15px; margin-bottom: 20px;">
            <p style="margin-top:0; font-weight: bold;">SELECT DIFFICULTY (SPEED):</p>
            <label><input type="radio" name="speed" value="0.5" checked> SLOW</label> &nbsp;
            <label><input type="radio" name="speed" value="1.0"> MEDIUM</label> &nbsp;
            <label><input type="radio" name="speed" value="2.2"> FAST</label>
        </div>
        <div class="grid" id="level-grid"></div>
    </div>

    <div id="game-screen" class="screen">
        <div class="stats-bar">
            <div class="stat-item">LVL: <span id="lvl-num">1</span></div>
            <div class="stat-item">‚úÖ <span id="correct-count">0</span></div>
            <div class="stat-item">‚ùå <span id="wrong-count">0</span></div>
            <div class="stat-item">‚è±Ô∏è <span id="timer">00</span>s</div>
            <div class="stat-item">WORD: <span id="word-num">1</span>/10</div>
        </div>
        <div id="game-area">
            <div id="feedback-mark"></div>
            <div id="floating-word" class="word-float"></div>
            <div id="splash-red" class="splash-fx"></div>
        </div>
        <div id="controls">
            <button class="btn-home" onclick="goHome()">üè† HOME</button>
            <button class="btn-replay" onclick="restartLevel()">üîÑ REPLAY</button>
            <button id="next-btn" onclick="nextLevel()" disabled>‚û°Ô∏è NEXT</button>
            <button class="btn-end" onclick="goHome()">üõë END</button>
        </div>
    </div>

<script>
    // 100 WORDS FROM YOUR LIST
    const allWords = ["AFTERNOON", "AGAIN", "ANT", "ARE", "ARM", "BASKET", "BATHROOM", "BE", "BEAR", "BEDROOM", "BEE", "BEHIND", "BENCH", "BETWEEN", "BICYCLE", "BIG", "BIRD", "BLACK", "BLUE", "BODY", "BOOK", "BROTHER", "BROWN", "BUTTERFLY", "CANDLE", "CAREFULLY", "CAT", "CHAIR", "CHESS", "CLASS", "CLASSMATE", "CLASSROOM", "CLOSE", "COLD", "COOK", "COW", "DANCE", "DESK", "DINING", "DOG", "DOLL", "DOOR", "DOWN", "DRAW", "DRESS", "DRINK", "EAGLE", "EAR", "EAT", "EIGHT", "EIGHTEEN", "ELEPHANT", "ELEVEN", "ERASER", "EVENING", "EYE", "FAST", "FAT", "FATHER", "FIFTEEN", "FIVE", "FLOWER", "FOOT", "FOUR", "FOURTEEN", "FRIEND", "FRONT", "FUR", "GIRAFFE", "GOOD", "GOODBYE", "GRASS", "GREEN", "HAIR", "HAMSTER", "HAND", "HAPPY", "HAT", "HE", "HELLO", "HER", "HI", "HIKE", "HILL", "HIPPO", "HIS", "HORSE", "HOT", "HOW", "ICE", "IN", "IS", "IT", "ITS", "KITCHEN", "LAUGH", "LEG", "LION", "LISTEN", "LIVING"];

    let levelWords = [], currentLevel = 1, wordIndex = 0;
    let activeWord = "", missingIndices = [], typedChars = "";
    let timeElapsed = 0, timerInterval, moveSpeed = 0.5;
    let totalCorrect = 0, totalWrong = 0;
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

    const grid = document.getElementById('level-grid');
    for(let i=1; i<=10; i++) {
        const btn = document.createElement('button');
        btn.innerText = `LEVEL ${i}`;
        btn.onclick = () => startLevel(i);
        grid.appendChild(btn);
    }

    function playSound(freq, type, duration) {
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.type = type;
        osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + duration);
        osc.connect(gain); gain.connect(audioCtx.destination);
        osc.start(); osc.stop(audioCtx.currentTime + duration);
    }

    function showFeedback(isCorrect) {
        const mark = document.getElementById('feedback-mark');
        const area = document.getElementById('game-area');
        mark.innerText = isCorrect ? '‚úÖ' : '‚ùå';
        mark.style.opacity = '1';
        if(!isCorrect) area.classList.add('shake');
        setTimeout(() => { mark.style.opacity = '0'; area.classList.remove('shake'); }, 300);
    }

    function startLevel(lvl) {
        moveSpeed = parseFloat(document.querySelector('input[name="speed"]:checked').value);
        currentLevel = lvl;
        wordIndex = 0;
        timeElapsed = 0;
        totalCorrect = 0;
        totalWrong = 0;
        updateScoreboard();
        levelWords = allWords.slice((lvl - 1) * 10, lvl * 10);
        document.getElementById('lvl-num').innerText = lvl;
        document.getElementById('next-btn').disabled = true;
        showScreen('game-screen');
        startTimer();
        nextWord();
    }

    function updateScoreboard() {
        document.getElementById('correct-count').innerText = totalCorrect;
        document.getElementById('wrong-count').innerText = totalWrong;
    }

    function startTimer() {
        clearInterval(timerInterval);
        timerInterval = setInterval(() => {
            timeElapsed++;
            document.getElementById('timer').innerText = timeElapsed;
        }, 1000);
    }

    function createSplash() {
        const area = document.getElementById('game-area');
        const splashOverlay = document.getElementById('splash-red');
        const guy = document.createElement('div');
        guy.className = 'fall-guy';
        guy.innerHTML = 'üèÉ‚Äç‚ôÇÔ∏è';
        area.appendChild(guy);

        let fallPos = -100;
        const fallTimer = setInterval(() => {
            fallPos += 50; 
            guy.style.top = fallPos + 'px';
            if(fallPos >= 320) {
                clearInterval(fallTimer);
                guy.innerHTML = 'üí• SPLASH! üí•';
                splashOverlay.style.display = 'block';
                playSound(50, 'sawtooth', 0.6);
                totalWrong += 5;
                updateScoreboard();
                setTimeout(() => { guy.remove(); splashOverlay.style.display = 'none'; }, 600);
            }
        }, 10);
    }

    function nextWord() {
        if(wordIndex >= levelWords.length) { finishLevel(); return; }
        document.getElementById('word-num').innerText = wordIndex + 1;
        activeWord = levelWords[wordIndex].toUpperCase().trim();
        typedChars = "";
        
        let numToHide = activeWord.length <= 4 ? 1 : 2;
        let availableIndices = [];
        for(let i=0; i<activeWord.length; i++) if(activeWord[i] !== " ") availableIndices.push(i);

        missingIndices = [];
        while(missingIndices.length < Math.min(numToHide, availableIndices.length)) {
            let r = availableIndices[Math.floor(Math.random() * availableIndices.length)];
            if(!missingIndices.includes(r)) missingIndices.push(r);
        }
        missingIndices.sort((a,b) => a-b);
        renderWord();
        animateWord();
    }

    function renderWord() {
        let html = "";
        for(let i=0; i<activeWord.length; i++) {
            if(activeWord[i] === " ") html += "   "; 
            else if(missingIndices.includes(i)) {
                let charIdx = missingIndices.indexOf(i);
                html += `<span class="missing">${typedChars[charIdx] || "_"}</span>`;
            } else {
                html += activeWord[i];
            }
        }
        document.getElementById('floating-word').innerHTML = html;
    }

    function animateWord() {
        const el = document.getElementById('floating-word');
        let pos = 0;
        if(window.gameInterval) clearInterval(window.gameInterval);
        window.gameInterval = setInterval(() => {
            pos += moveSpeed; 
            el.style.top = pos + "px";
            if(pos > 340) {
                clearInterval(window.gameInterval);
                createSplash(); wordIndex++;
                setTimeout(nextWord, 900);
            }
        }, 20);
    }

    window.addEventListener('keydown', (e) => {
        if(!document.getElementById('game-screen').classList.contains('active')) return;
        const key = e.key.toUpperCase();
        if(missingIndices.length === typedChars.length) return;
        const targetKey = activeWord[missingIndices[typedChars.length]];

        if(key === targetKey) {
            typedChars += key;
            totalCorrect++;
            showFeedback(true);
            playSound(600, 'sine', 0.1);
            renderWord();
            updateScoreboard();
            if(typedChars.length === missingIndices.length) {
                clearInterval(window.gameInterval);
                wordIndex++;
                setTimeout(nextWord, 500);
            }
        } else if(e.key.length === 1 && e.key !== "Shift") {
            totalWrong++;
            showFeedback(false);
            updateScoreboard();
            playSound(150, 'square', 0.1);
        }
    });

    function finishLevel() {
        clearInterval(timerInterval);
        document.getElementById('floating-word').innerHTML = `LEVEL CLEARED!`;
        document.getElementById('next-btn').disabled = currentLevel >= 10;
        playSound(800, 'sine', 0.4);
    }

    function showScreen(id) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
    }

    function goHome() { 
        clearInterval(window.gameInterval); 
        clearInterval(timerInterval); 
        showScreen('setup-screen'); 
    }
    function restartLevel() { startLevel(currentLevel); }
    function nextLevel() { startLevel(currentLevel + 1); }
</script>
</body>
</html>
